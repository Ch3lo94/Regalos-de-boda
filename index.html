<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0"> 
<title>Regalos de Boda</title>
<script src="https://accounts.google.com/gsi/client" async defer></script>

<style>
/* Estilos Base (Sin cambios) */
body {
Â  margin:0;
Â  background:#fafafa;
Â  font-family:"Segoe UI", sans-serif;
}

.center {Â 
Â  text-align:center;Â 
Â  width:90%;
Â  max-width:500px;
Â  padding:20px;
Â  box-sizing:border-box;
Â  margin:0 auto;
}

h1 { font-size:28px; margin-bottom:15px; }
h2 { font-size:24px; margin-bottom:10px; }
pÂ  { font-size:16px; line-height:1.4; }

.welcome-img {
Â  width:100%;
Â  max-width:420px;
Â  height:auto;
Â  border-radius:20px;
Â  box-shadow:0 4px 12px rgba(0,0,0,0.2);
}

.hidden { display:none; }

/* --- Grid adaptativo MODIFICADO --- */
.grid-wrapper {
Â  width:100%;
Â  padding:20px;
Â  box-sizing:border-box;
}

.grid {
Â  display: grid;
Â  /* âœ… MODIFICADO: Mantiene 2 columnas por defecto (min 200px) */
Â  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); 
Â  gap: 20px;
}

.card {
Â  background:white;
Â  border-radius:14px;
Â  overflow:hidden;
Â  cursor:pointer;
Â  border:3px solid transparent;
Â  transition:.25s ease;
Â  box-shadow:0 4px 12px rgba(0,0,0,0.1);
Â  display:flex;
Â  flex-direction:column;
}

.card:hover {
Â  transform: translateY(-4px);
Â  box-shadow:0 6px 16px rgba(0,0,0,0.12);
}

.selected {
Â  border:3px solid #d4af37 !important; /* borde dorado */
Â  box-shadow:0 6px 18px rgba(212,175,55,0.6) !important;
Â  transform: scale(1.02);
}

.card img {
Â  width:100%;
Â  /* âœ… MODIFICADO: Aumento altura para escritorio y tablets */
Â  height:220px; 
Â  object-fit:cover;
}

.card-content {Â 
Â  padding:16px;Â 
Â  flex-grow:1;
}

/* Banner inferior */
.agotado {
Â  opacity:0.5;
Â  pointer-events:none;
}
.agotado .agotado-banner {
Â  background:#d4af37;
Â  color:black;
Â  text-align:center;
Â  padding:8px 0;
Â  font-weight:bold;
Â  font-size:14px;
}

/* BotÃ³n confirmar (Sin cambios) */
#confirm-btn {
Â  display:block;
Â  margin:25px auto;
Â  padding:12px 30px;
Â  background:#d4af37;
Â  color:white;
Â  border:none;
Â  border-radius:12px;
Â  font-size:18px;
Â  cursor:pointer;
Â  transition:.25s ease;
}
#confirm-btn:hover:not(:disabled) {
Â  background:#c49e2a;
}
#confirm-btn:disabled {
Â  background:#aaa;
Â  cursor:not-allowed;
}

/* BotÃ³n Google (Sin cambios) */
#google-btn-wrapper {
Â  width:100%;
Â  display:flex;
Â  justify-content:center;
Â  align-items:center;
Â  margin-top:20px;
}

.g_id_signin > div,
.g_id_signin iframe {
Â  margin: 0 auto !important;
Â  display:block !important;
}

/* --- Responsive MODIFICADO --- */

/* Tablet landscape / Desktop pequeÃ±o */
@media (max-width: 1024px) {
Â  h1 { font-size:26px; }
Â  h2 { font-size:22px; }
Â  pÂ  { font-size:15px; }
Â  .card img { height:200px; } /* Se mantiene mÃ¡s grande que el original */
}

/* Tablet portrait / MÃ³viles grandes */
@media (max-width: 768px) {
Â  h1 { font-size:24px; }
Â  h2 { font-size:20px; }
Â  pÂ  { font-size:14px; }
Â  .card img { height:180px; }
Â  .card-content { padding:12px; }
}

/* âœ… CAMBIO CLAVE: Para MÃ³viles (Smartphones) */
@media (max-width: 600px) { 
Â  /* Forzamos una sola columna para hacer las tarjetas mucho mÃ¡s grandes */
Â  .grid {
Â  Â  grid-template-columns: 1fr; /* Una columna que ocupe el 100% del espacio */
Â  Â  gap: 15px; /* Reducimos el espacio entre tarjetas */
Â  }
Â  .grid-wrapper {
Â  Â  padding: 15px;
Â  }
Â  .card img { 
Â  Â  height: 250px; /* Hacemos la imagen mÃ¡s alta para que el producto destaque */
Â  }
Â  .card-content { padding: 16px; }
Â  h1 { font-size:22px; }
Â  h2 { font-size:18px; }
}

/* Para mÃ³viles muy pequeÃ±os (menos de 350px) */
@media (max-width: 350px) {
Â  .card img { 
Â  Â  height: 200px; 
Â  }
}
</style>
</head>

<body>

<div id="welcome" class="center">
Â  <img class="welcome-img" src="https://raw.githubusercontent.com/Ch3lo94/Regalos_Boda/main/images/IMG-20251127-WA0008.jpg">
Â  <h2>Nos ayudarÃ­as mucho con estas cosas que nos faltan â¤ï¸</h2>
Â  <p>IngresÃ¡ con tu cuenta de Google y seleccionÃ¡ lo que desees regalarnos.</p>

Â  <div id="google-btn-wrapper">
Â  Â  Â  <div id="g_id_onload"
Â  Â  Â  Â  data-client_id="342769047778-jc52eh3n59a3vjocagmomi8pln5kbqv3.apps.googleusercontent.com"
Â  Â  Â  Â  data-callback="handleCredentialResponse">
Â  Â  Â  </div>

Â  Â  Â  <div class="g_id_signin"
Â  Â  Â  Â  data-type="standard"
Â  Â  Â  Â  data-size="large"
Â  Â  Â  Â  data-theme="filled_blue">
Â  Â  Â  </div>
Â  </div>
</div>

<div id="catalogo" class="hidden">
Â  <h1 class="center">ElegÃ­ uno o mÃ¡s regalo</h1>
Â  <div class="grid-wrapper">
Â  Â  <div id="grid" class="grid"></div>
Â  </div>
Â  <button id="confirm-btn" disabled>Confirmar selecciÃ³n</button>
</div>

<script>
// El JavaScript es funcional y no necesita cambios.
const API = "https://script.google.com/macros/s/AKfycbyISWbCW9HkNFs_4tqYFjNrQW6GLU9F-MwytJq1f_ilyB0Y5lF3H7znpV_0CRCWiLSS/exec";

let usuario = null;
let seleccion = [];

// Mostrar mensaje final
function mostrarMensajeFinal() {
Â  document.body.innerHTML = `
Â  Â  <div class="center">
Â  Â  Â  <h1>Â¡Gracias por tu regalo! ğŸ</h1>
Â  Â  Â  <p>Tu respuesta ya quedÃ³ registrada â¤ï¸</p>
Â  Â  </div>`;
}

// Login Google
async function handleCredentialResponse(response) {
Â  const payload = JSON.parse(atob(response.credential.split('.')[1]));
Â  usuario = {
Â  Â  nombre: payload.given_name,
Â  Â  apellido: payload.family_name,
Â  Â  email: payload.email.trim().toLowerCase()
Â  };

Â  if (localStorage.getItem("respondio_" + usuario.email)) {
Â  Â  mostrarMensajeFinal();
Â  Â  return;
Â  }

Â  const valid = await fetch(API + "?email=" + usuario.email);
Â  const result = await valid.json();

Â  if (result.yaRespondio === true) {
Â  Â  localStorage.setItem("respondio_" + usuario.email, "1");
Â  Â  mostrarMensajeFinal();
Â  Â  return;
Â  }

Â  document.getElementById("welcome").classList.add("hidden");
Â  document.getElementById("catalogo").classList.remove("hidden");
Â  cargarCatalogo();
}

// Cargar catÃ¡logo
async function cargarCatalogo() {
Â  const res = await fetch(API);
Â  const items = await res.json();
Â  const grid = document.getElementById("grid");
Â  grid.innerHTML = "";

Â  items.forEach(item => {
Â  Â  const card = document.createElement("div");
Â  Â  card.className = "card";
Â  Â  if (item.stockRestante <= 0) card.classList.add("agotado");

Â  Â  card.innerHTML = `
Â  Â  Â  <img src="${item.imagen}">
Â  Â  Â  <div class="card-content">
Â  Â  Â  Â  <h3>${item.nombre}</h3>
Â  Â  Â  Â  <p>${item.descripcion || ''}</p>
Â  Â  Â  </div>
Â  Â  Â  ${item.stockRestante <= 0 ? '<div class="agotado-banner">Ya fue elegido</div>' : ''}
Â  Â  `;

Â  Â  card.onclick = () => toggle(item.id, card);
Â  Â  grid.appendChild(card);
Â  });
}

// SelecciÃ³n
function toggle(id, card) {
Â  if (seleccion.includes(id)) {
Â  Â  seleccion = seleccion.filter(x => x !== id);
Â  Â  card.classList.remove("selected");
Â  } else {
Â  Â  seleccion.push(id);
Â  Â  card.classList.add("selected");
Â  }
Â  document.getElementById("confirm-btn").disabled = seleccion.length === 0;
}

// Confirmar selecciÃ³n
document.getElementById("confirm-btn").onclick = async () => {
Â  const resp = await fetch(API, {
Â  Â  method: "POST",
Â  Â  body: JSON.stringify({
Â  Â  Â  nombre: usuario.nombre,
Â  Â  Â  apellido: usuario.apellido,
Â  Â  Â  email: usuario.email,
Â  Â  Â  seleccion
Â  Â  })
Â  });

Â  const r = await resp.json();

Â  if (r.success) {
Â  Â  localStorage.setItem("respondio_" + usuario.email, "1");
Â  Â  mostrarMensajeFinal();
Â  } else {
Â  Â  alert("Error: " + r.error);
Â  }
};
</script>

</body>
</html>
